{"version":3,"file":"useMenu.js","sources":["../../../../../../node_modules/@mui/base/MenuUnstyled/useMenu.js"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { unstable_useForkRef as useForkRef } from '@mui/utils';\nimport { defaultListboxReducer, useListbox, ActionTypes } from '../ListboxUnstyled';\nfunction stateReducer(state, action) {\n  if (action.type === ActionTypes.blur || action.type === ActionTypes.optionHover || action.type === ActionTypes.setValue) {\n    return state;\n  }\n  const newState = defaultListboxReducer(state, action);\n  if (action.type !== ActionTypes.setHighlight && newState.highlightedValue === null && action.props.options.length > 0) {\n    return _extends({}, newState, {\n      highlightedValue: action.props.options[0]\n    });\n  }\n  return newState;\n}\nexport default function useMenu(parameters = {}) {\n  const {\n    listboxRef: listboxRefProp,\n    open = false,\n    onClose,\n    listboxId\n  } = parameters;\n  const [menuItems, setMenuItems] = React.useState({});\n  const listboxRef = React.useRef(null);\n  const handleRef = useForkRef(listboxRef, listboxRefProp);\n  const registerItem = React.useCallback((id, metadata) => {\n    setMenuItems(previousState => {\n      const newState = _extends({}, previousState);\n      newState[id] = metadata;\n      return newState;\n    });\n  }, []);\n  const unregisterItem = React.useCallback(id => {\n    setMenuItems(previousState => {\n      const newState = _extends({}, previousState);\n      delete newState[id];\n      return newState;\n    });\n  }, []);\n  const {\n    getOptionState,\n    getOptionProps,\n    getRootProps,\n    highlightedOption,\n    setHighlightedValue: setListboxHighlight\n  } = useListbox({\n    options: Object.keys(menuItems),\n    optionStringifier: id => {\n      var _menuItems$id$ref$cur;\n      return menuItems[id].label || ((_menuItems$id$ref$cur = menuItems[id].ref.current) == null ? void 0 : _menuItems$id$ref$cur.innerText);\n    },\n    isOptionDisabled: id => {\n      var _menuItems$id;\n      return (menuItems == null ? void 0 : (_menuItems$id = menuItems[id]) == null ? void 0 : _menuItems$id.disabled) || false;\n    },\n    listboxRef: handleRef,\n    focusManagement: 'DOM',\n    id: listboxId,\n    stateReducer,\n    disabledItemsFocusable: true\n  });\n  const highlightFirstItem = React.useCallback(() => {\n    if (Object.keys(menuItems).length > 0) {\n      setListboxHighlight(menuItems[Object.keys(menuItems)[0]].id);\n    }\n  }, [menuItems, setListboxHighlight]);\n  const highlightLastItem = React.useCallback(() => {\n    if (Object.keys(menuItems).length > 0) {\n      setListboxHighlight(menuItems[Object.keys(menuItems)[Object.keys(menuItems).length - 1]].id);\n    }\n  }, [menuItems, setListboxHighlight]);\n  React.useEffect(() => {\n    if (!open) {\n      highlightFirstItem();\n    }\n  }, [open, highlightFirstItem]);\n  const createHandleKeyDown = otherHandlers => e => {\n    var _otherHandlers$onKeyD;\n    (_otherHandlers$onKeyD = otherHandlers.onKeyDown) == null ? void 0 : _otherHandlers$onKeyD.call(otherHandlers, e);\n    if (e.defaultPrevented) {\n      return;\n    }\n    if (e.key === 'Escape' && open) {\n      onClose == null ? void 0 : onClose();\n    }\n  };\n  const createHandleBlur = otherHandlers => e => {\n    var _otherHandlers$onBlur, _listboxRef$current;\n    (_otherHandlers$onBlur = otherHandlers.onBlur) == null ? void 0 : _otherHandlers$onBlur.call(otherHandlers, e);\n    if (!((_listboxRef$current = listboxRef.current) != null && _listboxRef$current.contains(e.relatedTarget))) {\n      onClose == null ? void 0 : onClose();\n    }\n  };\n  React.useEffect(() => {\n    var _listboxRef$current2;\n    // set focus to the highlighted item (but prevent stealing focus from other elements on the page)\n    if ((_listboxRef$current2 = listboxRef.current) != null && _listboxRef$current2.contains(document.activeElement) && highlightedOption !== null) {\n      var _menuItems$highlighte, _menuItems$highlighte2;\n      menuItems == null ? void 0 : (_menuItems$highlighte = menuItems[highlightedOption]) == null ? void 0 : (_menuItems$highlighte2 = _menuItems$highlighte.ref.current) == null ? void 0 : _menuItems$highlighte2.focus();\n    }\n  }, [highlightedOption, menuItems]);\n  const getListboxProps = (otherHandlers = {}) => {\n    const rootProps = getRootProps(_extends({}, otherHandlers, {\n      onBlur: createHandleBlur(otherHandlers),\n      onKeyDown: createHandleKeyDown(otherHandlers)\n    }));\n    return _extends({}, otherHandlers, rootProps, {\n      role: 'menu'\n    });\n  };\n  const getItemState = id => {\n    const {\n      disabled,\n      highlighted\n    } = getOptionState(id);\n    return {\n      disabled,\n      highlighted\n    };\n  };\n  React.useDebugValue({\n    menuItems,\n    highlightedOption\n  });\n  return {\n    registerItem,\n    unregisterItem,\n    menuItems,\n    getListboxProps,\n    getItemState,\n    getItemProps: getOptionProps,\n    highlightedOption,\n    highlightFirstItem,\n    highlightLastItem\n  };\n}"],"names":[],"mappings":"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"}